<!DOCTYPE html>
<html>

<body background="./InfoPattern.png">
    </style>
    <div>
        <div style="margin-top: 15px">
            <p id="p1" class="paragraph1"></p>
            <p id="p2" class="paragraph1">
            </p>
        </div>
        <style type="text/css">
            textarea {
                width: 410px;
                height: 250px;
                font-size: 12px;
                font-family: Verdana, Arial, Helvetica, sans-serif;
            }

            p {
                font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
                font-size: 20px;
                font-weight: bold;
            }
        </style>
        </select>

        <p> Input Values Data: </p>
        <textarea id="inputvalues" rows="20" cols="50"></textarea>
        <p> </p>
        <button onclick="calcPoints()">Convert Values Data</button>
        <p> </p>
        <textarea id="outputdata" rows="20" cols="50"></textarea>
        <p> </p>
        <button onclick="downloadsavedata()">Download CSV</button>
        <!--<textarea id="outputdata2" rows="20" cols="50"></textarea>
        <textarea id="outputdata3" rows="20" cols="50"></textarea>-->

    </div>
    <p> </p>
    <!--<textarea id="output" rows="20" cols="50"></textarea> -->
    <script src="./FileSaver.js"></script>
    <script src="./jszip.js"></script>
    <script>
        let driverN = { "0": 400, "8": 408, "17": 416, "27": 424, "38": 432, "50": 440, "63": 448, "77": 456, "92": 464, "108": 472, "126": 480, "146": 488, "168": 496, "192": 504, "218": 512, "246": 520, "276": 528, "308": 536, "342": 544, "378": 552, "417": 560, "459": 568, "504": 576, "552": 584, "603": 592, "657": 600, "714": 608, "772": 616, "831": 624, "891": 632, "952": 640, "1014": 648, "1077": 656, "1141": 664, "1206": 672, "1272": 680, "1339": 688, "1407": 696, "1476": 704, "1546": 712, "1617": 720, "1689": 728, "1762": 736, "1836": 744, "1911": 752, "1987": 760 }
        let driverS = { "0": 450, "8": 459, "17": 468, "27": 477, "38": 486, "50": 495, "63": 504, "77": 513, "92": 522, "108": 531, "126": 540, "146": 549, "168": 558, "192": 567, "218": 576, "246": 585, "276": 594, "308": 603, "342": 612, "378": 621, "417": 630, "459": 639, "504": 648, "552": 657, "603": 666, "657": 675, "714": 690, "772": 705, "831": 720, "891": 735, "952": 750, "1014": 765, "1077": 780, "1141": 795, "1206": 810, "1272": 825, "1339": 840, "1407": 855, "1476": 870, "1546": 885, "1617": 900, "1689": 915, "1762": 930, "1836": 945, "1911": 960, "1987": 975 }
        let driverH = { "0": 500, "8": 512, "17": 524, "27": 536, "38": 548, "50": 560, "63": 572, "77": 584, "92": 596, "108": 608, "126": 620, "146": 632, "168": 644, "192": 656, "218": 668, "246": 680, "276": 692, "308": 704, "342": 716, "378": 728, "417": 740, "459": 752, "504": 764, "552": 776, "603": 788, "657": 800, "714": 830, "772": 860, "831": 890, "891": 920, "952": 950, "1014": 980, "1077": 1010, "1141": 1040, "1206": 1070, "1272": 1100, "1339": 1130, "1407": 1160, "1476": 1190, "1546": 1220, "1617": 1250, "1689": 1280, "1762": 1310, "1836": 1340, "1911": 1370, "1987": 1400 }
        let kartsN = { "0": 200, "6": 204, "13": 208, "21": 212, "30": 216, "40": 220, "51": 224, "63": 228, "76": 232, "90": 236, "105": 240, "121": 244, "138": 248, "156": 252, "175": 256, "195": 260, "216": 264, "238": 268, "261": 272, "285": 276, "311": 280, "339": 284, "369": 288, "401": 292, "435": 296, "471": 300, "509": 304, "548": 308, "588": 312, "629": 316, "671": 320, "714": 324, "758": 328, "803": 332, "849": 336, "896": 340, "944": 344, "993": 348, "1043": 352, "1094": 356, "1146": 360, "1199": 364, "1253": 368, "1308": 372, "1364": 376, "1421": 380 }
        let kartsS = { "0": 220, "6": 224, "13": 228, "21": 232, "30": 236, "40": 240, "51": 244, "63": 248, "76": 252, "90": 256, "105": 260, "121": 264, "138": 268, "156": 272, "175": 276, "195": 280, "216": 285, "238": 290, "261": 295, "285": 300, "311": 305, "339": 310, "369": 315, "401": 320, "435": 325, "471": 330, "509": 336, "548": 342, "588": 348, "629": 354, "671": 360, "714": 366, "758": 372, "803": 378, "849": 384, "896": 390, "944": 396, "993": 402, "1043": 408, "1094": 414, "1146": 420, "1199": 426, "1253": 432, "1308": 438, "1364": 444, "1421": 450 }
        let kartsH = { "0": 250, "6": 256, "13": 262, "21": 268, "30": 274, "40": 280, "51": 286, "63": 292, "76": 298, "90": 304, "105": 310, "121": 316, "138": 322, "156": 328, "175": 334, "195": 340, "216": 346, "238": 352, "261": 358, "285": 364, "311": 370, "339": 376, "369": 382, "401": 388, "435": 394, "471": 400, "509": 415, "548": 430, "588": 445, "629": 460, "671": 475, "714": 490, "758": 505, "803": 520, "849": 535, "896": 550, "944": 565, "993": 580, "1043": 595, "1094": 610, "1146": 625, "1199": 640, "1253": 655, "1308": 670, "1364": 685, "1421": 700 }

        let pointsDB = { "0_0": { "0": 400, "8": 408, "17": 416, "27": 424, "38": 432, "50": 440, "63": 448, "77": 456, "92": 464, "108": 472, "126": 480, "146": 488, "168": 496, "192": 504, "218": 512, "246": 520, "276": 528, "308": 536, "342": 544, "378": 552, "417": 560, "459": 568, "504": 576, "552": 584, "603": 592, "657": 600, "714": 608, "772": 616, "831": 624, "891": 632, "952": 640, "1014": 648, "1077": 656, "1141": 664, "1206": 672, "1272": 680, "1339": 688, "1407": 696, "1476": 704, "1546": 712, "1617": 720, "1689": 728, "1762": 736, "1836": 744, "1911": 752, "1987": 760 }, "0_1": { "0": 450, "8": 459, "17": 468, "27": 477, "38": 486, "50": 495, "63": 504, "77": 513, "92": 522, "108": 531, "126": 540, "146": 549, "168": 558, "192": 567, "218": 576, "246": 585, "276": 594, "308": 603, "342": 612, "378": 621, "417": 630, "459": 639, "504": 648, "552": 657, "603": 666, "657": 675, "714": 690, "772": 705, "831": 720, "891": 735, "952": 750, "1014": 765, "1077": 780, "1141": 795, "1206": 810, "1272": 825, "1339": 840, "1407": 855, "1476": 870, "1546": 885, "1617": 900, "1689": 915, "1762": 930, "1836": 945, "1911": 960, "1987": 975 }, "0_2": { "0": 500, "8": 512, "17": 524, "27": 536, "38": 548, "50": 560, "63": 572, "77": 584, "92": 596, "108": 608, "126": 620, "146": 632, "168": 644, "192": 656, "218": 668, "246": 680, "276": 692, "308": 704, "342": 716, "378": 728, "417": 740, "459": 752, "504": 764, "552": 776, "603": 788, "657": 800, "714": 830, "772": 860, "831": 890, "891": 920, "952": 950, "1014": 980, "1077": 1010, "1141": 1040, "1206": 1070, "1272": 1100, "1339": 1130, "1407": 1160, "1476": 1190, "1546": 1220, "1617": 1250, "1689": 1280, "1762": 1310, "1836": 1340, "1911": 1370, "1987": 1400 }, "1_0": { "0": 200, "6": 204, "13": 208, "21": 212, "30": 216, "40": 220, "51": 224, "63": 228, "76": 232, "90": 236, "105": 240, "121": 244, "138": 248, "156": 252, "175": 256, "195": 260, "216": 264, "238": 268, "261": 272, "285": 276, "311": 280, "339": 284, "369": 288, "401": 292, "435": 296, "471": 300, "509": 304, "548": 308, "588": 312, "629": 316, "671": 320, "714": 324, "758": 328, "803": 332, "849": 336, "896": 340, "944": 344, "993": 348, "1043": 352, "1094": 356, "1146": 360, "1199": 364, "1253": 368, "1308": 372, "1364": 376, "1421": 380 }, "1_1": { "0": 220, "6": 224, "13": 228, "21": 232, "30": 236, "40": 240, "51": 244, "63": 248, "76": 252, "90": 256, "105": 260, "121": 264, "138": 268, "156": 272, "175": 276, "195": 280, "216": 285, "238": 290, "261": 295, "285": 300, "311": 305, "339": 310, "369": 315, "401": 320, "435": 325, "471": 330, "509": 336, "548": 342, "588": 348, "629": 354, "671": 360, "714": 366, "758": 372, "803": 378, "849": 384, "896": 390, "944": 396, "993": 402, "1043": 408, "1094": 414, "1146": 420, "1199": 426, "1253": 432, "1308": 438, "1364": 444, "1421": 450 }, "1_2": { "0": 250, "6": 256, "13": 262, "21": 268, "30": 274, "40": 280, "51": 286, "63": 292, "76": 298, "90": 304, "105": 310, "121": 316, "138": 322, "156": 328, "175": 334, "195": 340, "216": 346, "238": 352, "261": 358, "285": 364, "311": 370, "339": 376, "369": 382, "401": 388, "435": 394, "471": 400, "509": 415, "548": 430, "588": 445, "629": 460, "671": 475, "714": 490, "758": 505, "803": 520, "849": 535, "896": 550, "944": 565, "993": 580, "1043": 595, "1094": 610, "1146": 625, "1199": 640, "1253": 655, "1308": 670, "1364": 685, "1421": 700 } }

        function calcPoints() {
            console.log(convertToPoints(1113, 0, 0))
        }

        function newConvertToPoints(input, rarity, type) {
            let amounts = pointsDB[`${type}_${rarity}`];
            let amountsList = [];
            let remainder = input;
            console.log(`[input]` + input)
            console.log(amounts)
            amounts.forEach((k, i) => {
                amountsList.push(parseInt(k));
            });
            let amountsItr = 1;
            let range1 = 0;
            let range2 = amounts[amountItr];

        }

        function convertToPoints(input, rarity, type) {
            let points = 0;
            let iterate = 0;
            let remainder = input;
            let amounts = [];
            switch (rarity) {
                case 0:
                    switch (type) {
                        case 0:
                            Object.keys(driverN).forEach((k, i) => {
                                amounts.push(parseInt(k));
                            });
                            break;
                        case 1:
                            Object.keys(kartsN).forEach((k, i) => {
                                amounts.push(parseInt(k));
                            });
                            break;
                    }
                    break;
                case 1:
                    switch (type) {
                        case 0:
                            Object.keys(driverS).forEach((k, i) => {
                                amounts.push(parseInt(k));
                            });
                            break;
                        case 1:
                            Object.keys(kartsS).forEach((k, i) => {
                                amounts.push(parseInt(k));
                            });
                            break;
                    }
                    break;
                case 2:
                    switch (type) {
                        case 0:
                            Object.keys(driverH).forEach((k, i) => {
                                amounts.push(parseInt(k));
                            });
                            break;
                        case 1:
                            Object.keys(kartsH).forEach((k, i) => {
                                amounts.push(parseInt(k));
                            });
                            break;
                    }
                    break;
            }
            console.log(`[input]` + input)
            console.log(amounts)
            let amountItr = 0;
            //amounts.forEach((t:any,i:any) => {
            while ((remainder - amounts[amountItr]) >= 0) {
                console.log(remainder - amounts[amountItr]);
                amountItr++;
            }
            console.log(remainder - amounts[amountItr]);
            console.log(`AmountItr = [${amountItr}], points = ${input}, - value = ${amounts[amountItr]}`);
            //console.log(`Condition = ${input - parseInt(t) <= 0}`)
            points = amounts[amountItr - 1];
            remainder = input - amounts[amountItr - 1];
            let remain_progress = amounts[amountItr] - amounts[amountItr - 1];
            if(input == amounts[amounts.length-1]){
                points = amounts[amounts.length-1];
                remainder = 0;
            }
            if(input == amounts[31]){
                points = amounts[31];
                remainder = 0;
            }
            if(input == amounts[38]){
                points = amounts[38];
                remainder = 0;
            }
            if (input == 0) {
                points = 0;
                remainder = 0;
            }
            console.log(`[FINAL] AmountItr = [${amountItr}], Range = ${remainder} -> ${remain_progress},  points = ${input}, - value = ${amounts[amountItr]}`);
            switch (rarity) {
                case 0:
                    switch (type) {
                        case 0:
                            return driverN[`${points}`];
                        case 1:
                            return kartsN[`${points}`];
                    }
                    break;
                case 1:
                    switch (type) {
                        case 0:
                            return driverS[`${points}`];
                        case 1:
                            return kartsS[`${points}`];
                    }
                    break;
                case 2:
                    switch (type) {
                        case 0:
                            return driverH[`${points}`];
                        case 1:
                            return kartsH[`${points}`];
                    }
                    break;
            }
            console.log(`FinalOutput = ${points}, ${remainder}`)
            return [points, remainder];
        }

    </script>
    <style>
        p {
            color: Blue;
        }

        .paragraph1 {
            font-size: 12px;
            font-family: Verdana, Arial, Helvetica, sans-serif;
            line-height: 2px;
        }

        .paragraph2 {
            font-size: 13px;
            font-family: Verdana, Arial, Helvetica, sans-serif;
        }
    </style>
</body>

</html>